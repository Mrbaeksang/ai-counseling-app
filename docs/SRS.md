# 소프트웨어 요구사항 명세서 (SRS)

## 1. 개요

### 1.1 목적
본 문서는 AI 기반 철학자/상담사 상담 애플리케이션의 요구사항을 정의한다.

### 1.2 범위
- 프로젝트명: AI Counseling App
- 주요 기능: AI 페르소나와의 1:1 상담 대화
- 타겟 플랫폼: Android (Google Play Store)
- 백엔드: Spring Boot + Kotlin

### 1.3 용어 정의
- **상담사**: 역사적 인물 기반 AI 페르소나
- **세션**: 한 상담사와의 대화 단위
- **성격 매트릭스**: 상담사/사용자의 대화 성향을 수치화한 JSON
- **상담 단계**: AI가 자율 판단하는 대화 진행 단계

## 2. 기능 요구사항

### 2.1 사용자 관리
- **FR-001**: 소셜 로그인 (Google, Kakao)
- **FR-002**: 사용자 프로필 관리
- **FR-003**: 온보딩 프로세스 (선호도 파악)

### 2.2 상담사 매칭
- **FR-004**: 성격 매트릭스 기반 자동 매칭
- **FR-005**: AI 매칭 도우미와 대화
- **FR-006**: 상담사 직접 선택
- **FR-007**: 즐겨찾기 상담사 관리

### 2.3 상담 세션
- **FR-008**: 새 세션 시작
- **FR-009**: AI 자율 단계 진행
  - 라포 형성 → 문제 탐색 → 패턴 분석 → 개입 → 계획 → 마무리
- **FR-010**: 자연스러운 마무리 제안
- **FR-011**: 세션 요약 생성
- **FR-012**: 이전 대화 연속성 유지

### 2.4 메시지 관리
- **FR-013**: 실시간 대화
- **FR-014**: 메시지 북마크
- **FR-015**: 대화 내역 조회

### 2.5 평가 시스템
- **FR-016**: 세션 종료 후 평가
- **FR-017**: 상담사 리뷰 작성

## 3. 비기능 요구사항

### 3.1 성능
- **NFR-001**: API 응답 시간 < 2초
- **NFR-002**: OpenRouter API 타임아웃 60초
- **NFR-003**: 동시 접속 1000명 지원

### 3.2 보안
- **NFR-004**: JWT 기반 인증
- **NFR-005**: API 키 환경변수 관리
- **NFR-006**: HTTPS 통신

### 3.3 사용성
- **NFR-007**: 현대적 언어 사용 (고어체 금지)
- **NFR-008**: 자연스러운 대화 흐름
- **NFR-009**: 모바일 최적화 UI

### 3.4 확장성
- **NFR-010**: 상담사 추가 용이
- **NFR-011**: 다국어 지원 가능 구조

## 4. 시스템 제약사항

### 4.1 기술 스택
- Backend: Kotlin, Spring Boot 3.5, WebFlux
- Database: PostgreSQL (운영), H2 (개발)
- Cache: Redis
- AI: OpenRouter API (liquid/lfm-40b)
- Architecture: Clean Architecture

### 4.2 운영 환경
- JDK 21
- Docker/Kubernetes (추후)
- GitHub Actions CI/CD

## 5. 인터페이스 요구사항

### 5.1 외부 인터페이스
- OpenRouter API 연동
- OAuth 2.0 (Google, Kakao)

### 5.2 API 인터페이스
- RESTful API
- OpenAPI 3.0 문서화
- JSON 통신

## 6. 데이터 요구사항

### 6.1 데이터 모델
- users: 사용자 정보 + 선호 매트릭스
- counselors: 상담사 정보 + 성격 매트릭스
- chat_sessions: 세션 정보 + AI 판단 단계
- messages: 대화 내용
- session_summaries: AI 생성 요약

### 6.2 데이터 보존
- 대화 내역: 1년 보관
- 사용자 정보: 탈퇴 시까지
- 세션 요약: 영구 보관

## 7. AI 상담 로직

### 7.1 매칭 알고리즘
```kotlin
// 성격 매트릭스 비교 (코사인 유사도)
{
  "logical": 0-100,      // 논리적 vs 감성적
  "directness": 0-100,   // 직설적 vs 완곡한
  "solutionFocus": 0-100, // 해결중심 vs 공감중심
  "formalityLevel": 0-100 // 격식있는 vs 친근한
}
```

### 7.2 상담 단계 자동 진행
- AI가 대화 맥락을 보고 자율 판단
- 고정 턴 수 없이 유연하게 진행
- 사용자 신호 감지 (수용, 저항, 준비도)

### 7.3 프롬프트 구조
```
1. 상담사 기본 성격
2. 현재 대화 기록
3. 단계 판단 지시
4. 언어 스타일 (현대적, 친근한)
5. 메타 발언 금지
```

## 8. 품질 요구사항

### 8.1 테스트
- 단위 테스트 커버리지 > 80%
- 통합 테스트 필수
- E2E 테스트 (추후)

### 8.2 문서화
- API 문서 자동 생성 (Swagger)
- 코드 주석 최소화
- README 유지보수

## 9. 프로젝트 일정

### Phase 1 (MVP)
- 기본 상담 기능
- 3명 상담사
- 자유 대화

### Phase 2
- AI 단계 판단
- 매칭 시스템
- 세션 요약

### Phase 3
- Android 앱
- 30명 상담사
- 평가 시스템

## 10. 위험 관리

### 10.1 기술적 위험
- OpenRouter API 의존성 → 폴백 전략
- AI 응답 품질 → 프롬프트 최적화
- 응답 속도 → 캐싱 전략

### 10.2 비즈니스 위험
- 사용자 이탈 → 온보딩 개선
- 부적절한 상담 → 면책 조항
- 확장성 → 클라우드 인프라